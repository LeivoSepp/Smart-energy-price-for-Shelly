let _={sId:0,mc:3,ct:0};function start(e){Shelly.call("KVS.Get",{key:"schedulerIDs"+e},(function(e,l,t,c){if(e){let l=[];l=JSON.parse(e.value),e=null,delSc([l,c.sId])}}),{sId:e})}function delSc(e){let l=e[0],t=e[1];if(_.ct<6-_.mc)for(let e=0;e<_.mc&&e<l.length;e++){let e=l.splice(0,1)[0];_.ct++,Shelly.call("Schedule.Delete",{id:e},(function(e,l,c,d){0!==l?print("Script #"+t,"schedule ",d.id," del FAIL."):print("Script #"+t,"schedule ",d.id," del OK."),_.ct--}),{id:e})}l.length>0?Timer.set(1e3,!1,delSc,[l,t]):delKVS(t)}function delKVS(e){0===_.ct?(Shelly.call("KVS.Delete",{key:"schedulerIDs"+e}),print("Heating script #"+e,"is clean")):Timer.set(1e3,!1,delKVS,e)}Shelly.addStatusHandler((function(e){"script"!==e.name||e.delta.running||(_.sId=e.delta.id,start(_.sId))}));